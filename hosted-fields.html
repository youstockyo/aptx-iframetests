<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://applepay.cdn-apple.com/jsapi/v1/apple-pay-sdk.js"></script>
<!--     <script src="https://test.aptx.cm/hf-jest2/script/aptx-hosted-fields.js"></script> -->
	<script src="https://api.aptx.cm/script/aptx-hosted-fields.js"></script>
    <style>
        body,
        body * {
            box-sizing: border-box;
        }

        body * {
            font-family: "Open Sans", Arial, Helvetica, sans-serif;
            font-size: 1em;
        }

        body {
            padding: 20px;
            background-color: #c5d8d1;
        }

        h1 {
            font-size: 2em;
            margin: 1em auto 0 auto;
        }

        .form-wrapper {
            display: flex;
            margin: 1em auto;
            background-color: #eef1ef;
            border-radius: 3px;
            padding: 2.5em;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
        }

        .form-field {
            margin-bottom: 20px;
        }

        .field-container {
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 100%;
            height: 2.5em;
            margin-top: 7px;
            padding: 5px 7px 3px 7px;
            border: 2px solid darkgrey;
            border-radius: 5px;
            background-color: #ffffff;
        }

        .fee-div {
            margin-bottom: 20px;
        }

        .fee-display {
            display: flex;
            align-items: center;
            max-width: 325px;
            height: 2em;
        }

        .field-container > iframe,
        .fee-display > iframe {
            border: none;
            margin: 0px;
            padding: 0px;
            width: 1px;
            min-width: 100%;
            height: 100%;
            overflow: hidden;
            display: block;
        }

        button {
            padding: 15px 50px;
            background-color: #4d685a;
            color: #ffffff;
            cursor: pointer;
            font-weight: 700;
            text-transform: uppercase;
            line-height: inherit;
            position: relative;
            text-decoration: none;
            text-align: center;
            border-style: solid;
            border-width: 1px;
            border-radius: 3px;
            display: inline-block;
            margin: 0 auto;
        }

        .button-container {
            text-align: right;
        }

        .mw-button > iframe {
            border: none;
            margin: 0px;
            padding: 0px;
            min-width: 100%;
            height: 100%;
            overflow: hidden;
            display: block;
        }

        .mw-button {
            height: 55px;
            min-width: 350px;
            margin-bottom: 18px;
        }

        .paypal-later-msg-container,
        .paypal-later-msg-container > iframe {
            height: 50px;
        }

        .paypal-submit-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .item-description {
            display: flex;
            margin-top: 40px;
            margin-bottom: 40px;
            width:100%;
        }



        .nav {
            margin-bottom: 25px;
            display: flex;
        }
        .nav li {
            flex: 1;
        }
        .nav li button {
            color: #4d685a;
        }
        .nav-pills .nav-link.active, .nav-pills .show > .nav-link {
            background: transparent;
            border: 3px solid #4d685a;
            color: #4d685a;
        }
        .nav-link:focus, .nav-link:hover {
            color: #4d685a;
        }
        .is--block {
            display: block;
        }
        .reload-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        .config-data {
            padding-right: 60px;
            margin-right: 125px;
            border-right: 2px solid darkgrey;
        }
        apple-pay-button {
  			--apple-pay-button-width: 400px;
  			--apple-pay-button-height: 56px;
  			--apple-pay-button-border-radius: 5px;
  			--apple-pay-button-padding: 5px 0px;
		}
        select {
            background-color: #ffffff;
            outline: 0;
            border-radius: 3px;
            border: 1px solid darkgrey;
            /* appearance: none; */
        }
    </style>
    <title>Hosted Fields Test</title>
</head>

<body>
    <h1>
        Hosted Fields Test
    </h1>
    <div class="form-wrapper">

        <div class="config-data">
        	<h2 style="font-weight: bold;">Config Data</h2>
            <div class="form-field">
                Session Id
                <input class="is--block" id="aptxQaSessionId" type="text">
            </div>
            <div class="form-field">
                API Token
                <input class="is--block" id="aptxQaTokenId" type="text">
            </div>	                
            <div class="form-field">
                Amount (in cents)
                <input class="is--block" id="aptxQaAmount" type="text">
            </div>
        
            <div class="form-field">
                Account Person Id
                <input class="is--block" id="aptxQaAccountPersonId" type="text">
            </div>
            <div class="form-field">
                Account Target Id
                <input class="is--block" id="aptxQaTargetId" type="text">
            </div>
            <div class="form-field">
                Merchant Id
                <input class="is--block" id="aptxQaMerchantId" type="text">
            </div>
            <div class="form-field">
                testEnv
                <div>
                    <label>
                        <input type="radio" id="testEnvTrue" name="testEnv" value=true checked />
                        <span>True</span>
                    </label>
                    <label>
                        <input type="radio" id="testEnvTrue" name="testEnv" value="false" />
                        <span>False</span>
                    </label>
                </div>
            </div>
            <button id="submitConfigButton"
                style="margin-right: 0; padding-top: 5px; padding-bottom: 5px; height: 40px;"
                onclick="reload()">
                Submit Config
            </button>
        </div>

        <div style="width: 760px;">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-bank-tab" data-bs-toggle="pill" data-bs-target="#pills-bank" type="button" role="tab" aria-controls="pills-bank" aria-selected="true">Add Bank</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-card-tab" data-bs-toggle="pill" data-bs-target="#pills-card" type="button" role="tab" aria-controls="pills-card" aria-selected="false">Add Card</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-paypal-tab" data-bs-toggle="pill" data-bs-target="#pills-paypal" type="button" role="tab" aria-controls="pills-paypal" aria-selected="false">PayPal</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-venmo-tab" data-bs-toggle="pill" data-bs-target="#pills-venmo" type="button" role="tab" aria-controls="pills-venmo" aria-selected="false">Venmo</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-bitpay-tab" data-bs-toggle="pill" data-bs-target="#pills-bitpay" type="button" role="tab" aria-controls="pills-bitpay" aria-selected="false">BitPay</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-applepay-tab" data-bs-toggle="pill" data-bs-target="#pills-applepay" type="button" role="tab" aria-controls="pills-card" aria-selected="false">ApplePay</button>
                </li>
            </ul>
            <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-bank">
                    <div class="form-field">
                        <label for="account-name-container">Name</label>
                        <div id="account-name-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        <label for="routing-container">Bank Routing Number</label>
                        <div id="routing-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        <label for="account-container">Bank Account Number</label>
                        <div id="account-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        <label for="confirm-account-container">Confirm Bank Account Number</label>
                        <div id="confirm-account-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        <label for="account-type-container">Account Type</label>
                        <div id="account-type-container" class="field-container"></div>
                    </div>
                    <div class="button-container">
                        <button onclick="submitForm();">
                            Submit Method
                        </button>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-card">
                    <div class="form-field">
                        Name
                        <div id="card-name-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        Card Number
                        <div id="card-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        Expiration Date
                        <div id="expiration-container" class="field-container"></div>
                    </div>
                    <div class="form-field">
                        Zip Code
                        <div id="zip-container" class="field-container"></div>
                    </div>
                    <div class="button-container">
                        <button onclick="submitForm();">
                            Submit Method
                        </button>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-paypal">
                    
                    <div id="paypalTab" class="paypal-submit-container">
                        <div id="paypal-container"
                            class="mw-button">
                        </div>
                        <div id="paypal-later-container"
                            class="mw-button">
                        </div>
                        <div id="paypal-later-msg-container"></div>
                    </div>
                </div>
                <div class="tab-pane fade" id="pills-venmo">
                    <div id="venmo-container"
                        class="venmo-button-container"></div>
                </div>
                <div class="tab-pane fade" id="pills-applepay">
                    <div id="applepay-container"
                        class="applepay-button-container"></div>
                </div>
                <div class="tab-pane fade" id="pills-bitpay">
                    <div id="bitpay-container"
                        class="bitpay-button-container"></div>
                </div>
            </div>
        </div>
        
    </div>

    <div style="padding-top: 1em;">
        <h2 style="font-weight: bold;">Feedback</h2>
        <div style="display: flex;">
            <div class="form-field" style="margin-right: 25px;">
                Method Id
                <textarea class="is--block" id="methodIdField" type="text" readonly></textarea>
            </div>
                <div class="form-field" style="margin-right: 25px;">
                Payment Id
                <textarea class="is--block" id="paymentIdField" type="text" readonly></textarea>
                </div>
            <div class="form-field" style="margin-right: 25px;">
                Order Id
                <textarea class="is--block" id="orderIdField" type="text" readonly></textarea>
            </div>
            <div class="form-field">
                Error
                <textarea class="is--block" id="errorIdField" type="text" readonly></textarea>
            </div>
        </div>
        
    </div>
    
    <script>
        function submitForm()
        {
            var methodType;
            var activeTab = document.querySelector('.nav-link.active');

            if(activeTab.id == 'pills-bank-tab')
            {
                methodType = 'BANK';
            }
            else
            {
                methodType = 'CARD';
            }

            aptxFields.submit(methodType);
        };
        
        function callbackFunc(data)
        {
            console.log("this is the callbackFunc", data)
            if(data.methodId !== undefined)
            {
            	document.getElementById("methodIdField").value = data.methodId;
            }
            else
            {
            	document.getElementById("errorIdField").value = JSON.stringify(data);
            }
        };

        function paymentCallbackFunc(data)
        {
            console.log("this is the paymentCallbackFunc", JSON.stringify(data))
            document.getElementById("paymentIdField").value = data.paymentId;
            if(data.orderID !== undefined)
            {
            	   document.getElementById("orderIdField").value = data.orderID;
            }
             document.getElementById("methodIdField").value = data.methodId;
       };

        function payPalApproveCallbackFunc(data)
        {
            console.log("this is the payPalApproveCallback", data)
            document.getElementById("orderIdField").value = data.paypalOrderId;
            aptxFields.submitPayment(data)
        };

        function payPalErrorCallbackFunc(data)
        {
            console.log("this is the payPalErrorCallback", data);
            
            if(data !== {})
            {
            	document.getElementById("errorIdField").value = JSON.stringify(data);
            }
            //throw Error( JSON.stringify(data));
        };
        
        function bitPayCallbackFunc(data)
        {
            console.log("this is the bitPayCallback", JSON.stringify(data))
            document.getElementById("orderIdField").value = data.bitpayInvoiceId;
            aptxFields.submitPayment(data)
        	
        };
        
        function bitPayErrorCallbackFunc(data)
        {
            console.log("this is the bitPayErrorCallback", JSON.stringify(data))
            document.getElementById("errorIdField").value = JSON.stringify(data);
        	
        };
        
        function applePayCallbackFunc(data)
        {
            console.log("this is the applePayCallback", JSON.stringify(data))
            document.getElementById("paymentIdField").value = data.invoiceId;
            document.getElementById("methodIdField").value = data.methodId;
            document.getElementById("orderIdField").value = data.paypalOrderId;
        };
        
        function applePayErrorCallbackFunc(data)
        {
            console.log("this is the applePayErrorCallback", JSON.stringify(data))
            document.getElementById("errorIdField").value = JSON.stringify(data);
        	
        };
        
        
        
        function getPaymentAmount()
        {
            console.log('getPaymentAmount() returns ' + document.getElementById("aptxQaAmount").value);
            return document.getElementById("aptxQaAmount").value;
        };
        
        function getSessionId()
        {
            console.log('getSessionId() returns ' + document.getElementById("aptxQaSessionId").value);
            return document.getElementById("aptxQaSessionId").value;
        };

        function getTokenId()
        {
            console.log('getTokenId() returns ' + document.getElementById("aptxQaTokenId").value);
            return document.getElementById("aptxQaTokenId").value;
        };

        function getTargetId()
        {
        	console.log('getTargetId() returns ' + document.getElementById("aptxQaTargetId").value);
            return document.getElementById("aptxQaTargetId").value;
        };
        
        function getAccountPersonId()
        {
        	console.log('getAccountPersonId() returns ' + document.getElementById("aptxQaAccountPersonId").value);
            return document.getElementById("aptxQaAccountPersonId").value;
        };

        function getMerchantId()
        {
        	console.log('getMerchantId() returns ' + document.getElementById("aptxQaMerchantId").value);
            return document.getElementById("aptxQaMerchantId").value;
        };

        function getTestEnv()
        {
            var selectedTestEnvInput = document.querySelector('input[name="testEnv"]:checked');   

        	console.log('getTestEnv() returns ' + selectedTestEnvInput.value);
            if(selectedTestEnvInput.value == "true")
            {
                return true;
            }
            else
            {
                return false;
            }
        };
        
        function reload()
        {
        	config.sessionId = getSessionId();
        	config.token = getTokenId();
        	document.getElementById("methodIdField").value = "";
        	document.getElementById("errorIdField").value = "";
        	document.getElementById("paymentIdField").value = "";
        	document.getElementById("orderIdField").value = "";
            config.accountPersonId = getAccountPersonId();
            config.accountTargetId = getTargetId();
            config.amount = getPaymentAmount();
            config.merchantId = getMerchantId();
            config.testEnv = getTestEnv();
            console.log(config);
            aptxFields.setup(config);
        };

        function getFeeData(data)
        {
            console.log('this is the fee callback', data);
        };

        var config = 
        {
            sessionId: getSessionId(),
            accountPersonId: getAccountPersonId(),
            accountTargetId: getTargetId(),
            production: false,
            testEnv: getTestEnv(),
            apxDev: true,
            token: getTokenId(),
            amount: getPaymentAmount(),
            merchantId: getMerchantId(),
            context: "release_20240408",
            domain: "https://youstockyo.github.io",
            fields:
            [
                {
                    type: "ACCOUNT_NAME",
                    id: "account-name-container",
                    placeholder: "Account Name",
                    style:
                    {
                        fontSize: "18px",
                        fontWeight: "bold",
                        height: "24px",
                        padding: "5px 10px"
                    }
                },
                {
                    type: "ACCOUNT_NUMBER",
                    id: "account-container"
                },
                {
                    type: "ACCOUNT_NUMBER_CONFIRM",
                    id: "confirm-account-container"
                },
                {
                    type: "ROUTING_NUMBER",
                    id: "routing-container"
                },
                {
                    type: "ACCOUNT_TYPE",
                    id: "account-type-container",
                    style:
                    {
                        fontFamily: "'Open Sans', sans-serif",
                        fontSize: "12px",
                        fontWeight: "bold",
                        color: "Tomato"
                    }
                },
                {
                    type: "CARD_NAME",
                    id: "card-name-container"
                },
                {
                    type: "CARD_NUMBER",
                    id: "card-container",
                    placeholder: "Card Number",
                    getFee: true
                },
                {
                    type: "EXPIRATION_DATE",
                    id: "expiration-container"
                },
                {
                    type: "ZIP_CODE",
                    id: "zip-container"
                },
                {
                    type: "PAYPAL_BUTTONS",
                    merchantId: "Y3RLY7GZUCKJN",
                    accountTargetId: "12304872",
                    token: "0LFTVNYF5JTJPPAP",
                    amount: getPaymentAmount(),
                    payPalType:
                    [
                        {
                            type: "PAYPAL",
                            id: "paypal-container",
                            buttonColor: "white"
                        },
                        {
                            type: "PAYPAL_LATER",
                            id: "paypal-later-container",
                            buttonColor: "white"
                        },
                        {
                            type: "PAYPAL_LATER_MSG",
                            id: "paypal-later-msg-container",
                        }, 
                        {
                            type: "VENMO",
                            id: "venmo-container"
                        }, 
                        {
                            type: "APPLE_PAY",
                            id: "applepay-container"
                        }
                    ]
                }
            ],
            callback: callbackFunc,
            feeDataCallback: getFeeData,
            payPalApproveCallback: payPalApproveCallbackFunc,
            payPalErrorCallback: payPalErrorCallbackFunc,
            paymentCallback : paymentCallbackFunc,
            bitPayCallback : bitPayCallbackFunc,
            bitPayErrorCallback : bitPayErrorCallbackFunc,
            applePayCallback : applePayCallbackFunc,
            applePayErrorCallback : applePayErrorCallbackFunc
        }

        aptxFields.setup(config)
    </script>
</body>
</html>

